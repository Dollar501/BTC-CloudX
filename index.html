<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>BTC-CloudX</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --tg-theme-bg-color: #0d1117;
            --tg-theme-text-color: #e6edf3;
            --tg-theme-hint-color: #7d8590;
            --tg-theme-link-color: #58a6ff;
            --tg-theme-button-color: #238636;
            --tg-theme-button-text-color: #ffffff;
            --tg-theme-secondary-bg-color: #161b22;
        }
        body {
            background-color: var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            font-family: 'Cairo', sans-serif;
            margin: 0;
            padding-bottom: 80px; /* Space for bottom nav */
            background-image: url('https://www.transparenttextures.com/patterns/cubes.png');
            background-attachment: fixed;
        }
        .page { display: none; animation: fadeIn 0.5s; }
        .page.active { display: block; }
        .bottom-nav {
            background-color: rgba(22, 27, 34, 0.8);
            backdrop-filter: blur(10px);
            border-top: 1px solid #30363d;
        }
        .nav-btn.active { color: var(--tg-theme-button-color); border-top: 2px solid var(--tg-theme-button-color); }
        .form-input, .form-select, .form-range {
            background-color: #010409;
            border: 1px solid #30363d;
            color: var(--tg-theme-text-color);
        }
        .form-range::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: var(--tg-theme-button-color);
            cursor: pointer;
            border-radius: 50%;
        }
        .form-range::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: var(--tg-theme-button-color);
            cursor: pointer;
            border-radius: 50%;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px);
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: var(--tg-theme-secondary-bg-color);
            margin: auto;
            padding: 20px;
            border: 1px solid #30363d;
            width: 90%;
            max-width: 500px;
            border-radius: 12px;
            animation: fadeIn 0.3s;
        }
        .close-button {
            color: var(--tg-theme-hint-color);
            float: left; /* RTL support */
            font-size: 28px;
            font-weight: bold;
        }
        .close-button:hover, .close-button:focus {
            color: #fff;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body class="antialiased">

    <main class="p-4 space-y-6">
        <!-- Page: Home -->
        <section id="home-page" class="page active text-center">
            <img src="img/logo.png" alt="BTC-CloudX Logo" class="rounded-full mx-auto mb-4 border-2 border-green-500">
            <h1 class="text-4xl font-bold text-white">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ BTC-CloudX</h1>
            <p class="text-lg text-gray-300 mt-2">Ø¨ÙˆØ§Ø¨ØªÙƒ Ø§Ù„Ø¢Ù…Ù†Ø© Ù„Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± ÙÙŠ Ù…Ø³ØªÙ‚Ø¨Ù„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ† Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠ. Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ© Ù…Ø¹Ù†Ø§ Ø§Ù„ÙŠÙˆÙ….</p>
        </section>

        <!-- Page: Investment Plans -->
        <section id="plans-page" class="page">
            <h1 class="text-3xl font-bold mb-4">ğŸ“Š Ø§Ù„Ø®Ø·Ø· Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ© Ø§Ù„Ù…Ù…ÙŠØ²Ø©</h1>
            <div id="plans-container" class="space-y-5">
                <!-- Plan cards will be injected here -->
            </div>
        </section>

        <!-- Page: Our Hardware -->
        <section id="hardware-page" class="page">
            <h1 class="text-3xl font-bold mb-4">ğŸ“  Ø£Ø¬Ù‡Ø²ØªÙ†Ø§ Ù„Ù„ØªØ¹Ø¯ÙŠÙ†</h1>
            <div id="hardware-container" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Hardware cards will be injected here -->
            </div>
        </section>

        <!-- Page: Create Custom Plan -->
        <section id="create-plan-page" class="page space-y-6">
            <h1 class="text-3xl font-bold">ğŸ’¡ ØµÙ…Ù‘Ù… Ø®Ø·ØªÙƒ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ©</h1>
            <div>
                <label for="investment_amount" class="block mb-2 text-md font-medium">1. Ø­Ø¯Ø¯ Ù…Ø¨Ù„Øº Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± (Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±)</label>
                <input type="number" id="investment_amount" class="form-input block w-full p-3 rounded-lg text-center text-xl" placeholder="Ù…Ø«Ø§Ù„: 1000" value="1000" min="999">
            </div>
            <div>
                <label for="investment_duration" class="block mb-2 text-md font-medium">2. Ø­Ø¯Ø¯ Ù…Ø¯Ø© Ø§Ù„Ø¹Ù‚Ø¯ (Ø³Ù†ÙˆØ§Øª)</label>
                <input type="range" id="investment_duration" class="form-range w-full h-2 rounded-lg appearance-none cursor-pointer" min="1" max="3" value="1" step="1">
                <div class="flex justify-between text-xs px-1 mt-1">
                    <span>Ø³Ù†Ø© ÙˆØ§Ø­Ø¯Ø©</span>
                    <span>Ø³Ù†ØªØ§Ù†</span>
                    <span>3 Ø³Ù†ÙˆØ§Øª</span>
                </div>
                <p class="text-center text-xl font-bold mt-2"><span id="duration_display">1</span> Ø³Ù†Ø©</p>
            </div>
            <button id="calculate-plan-btn" class="w-full text-white p-3 rounded-lg font-bold text-lg" style="background-color: var(--tg-theme-button-color);">Ø§Ø­Ø³Ø¨ Ø§Ù„Ø®Ø·Ø©</button>
            
            <div id="plan-results" class="hidden bg-[var(--tg-theme-secondary-bg-color)] p-4 rounded-lg space-y-3">
                <!-- Results will be shown here -->
            </div>
        </section>

        <!-- Page: FAQ -->
        <section id="faq-page" class="page space-y-4">
            <h1 class="text-3xl font-bold">â“ Ø£Ø³Ø¦Ù„Ø© Ø´Ø§Ø¦Ø¹Ø©</h1>
            <div id="faq-container" class="space-y-3">
                <!-- FAQ items will be injected here -->
            </div>
        </section>
    </main>

    <!-- Bottom Navigation Bar -->
    <nav class="bottom-nav fixed bottom-0 left-0 right-0 flex justify-around p-2">
        <button data-page="home-page" class="nav-btn active flex flex-col items-center w-full py-1">
            <span class="text-2xl">ğŸ </span><span class="text-xs">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
        </button>
        <button data-page="plans-page" class="nav-btn flex flex-col items-center w-full py-1">
            <span class="text-2xl">ğŸ“Š</span><span class="text-xs">Ø§Ù„Ø®Ø·Ø·</span>
        </button>
        <button data-page="hardware-page" class="nav-btn flex flex-col items-center w-full py-1">
            <span class="text-2xl">ğŸ“ </span><span class="text-xs">Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©</span>
        </button>
        <button data-page="create-plan-page" class="nav-btn flex flex-col items-center w-full py-1">
            <span class="text-2xl">ğŸ’¡</span><span class="text-xs">Ø®Ø·Ø© Ø®Ø§ØµØ©</span>
        </button>
        <button data-page="faq-page" class="nav-btn flex flex-col items-center w-full py-1">
            <span class="text-2xl">â“</span><span class="text-xs">Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</span>
        </button>
    </nav>
    
    <!-- Modal for Hardware Details -->
    <div id="hardware-modal" class="modal" style="display: none;">
      <div class="modal-content">
        <span class="close-button" onclick="this.parentElement.parentElement.style.display='none'">&times;</span>
        <div id="modal-body" class="text-center"></div>
      </div>
    </div>
    
    <!-- Modal for Plan Confirmation -->
    <div id="plan-confirmation-modal" class="modal" style="display: none;">
      <div class="modal-content">
        <div id="plan-modal-body" class="text-center">
            <!-- Plan details will be injected here -->
        </div>
        <div id="plan-modal-footer" class="mt-4 flex justify-around">
            <!-- Yes/No buttons will be injected here -->
        </div>
      </div>
    </div>

    <script>
       const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        // --- CONFIG & DATA ---
        const TELEGRAM_SUPPORT_URL = "https://t.me/BTC_CloudX";

        const DATA = {
    // Ù‚Ø³Ù… Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ†
    HARDWARE: [
        { 
            id: 's21xp_hydro', 
            name: 'Antminer S21 XP Hydro', 
            efficiency: '12.0 J/TH', 
            image: "img/antminer_s21xp_hydro.jpg" 
        },
        { 
            id: 's21xp', 
            name: 'Antminer S21 XP', 
            efficiency: '13.5 J/TH', 
            image: "img/Antminer_S21_XP_270TH.jpg" 
        },
        { 
            id: 'm66s', 
            name: 'WhatsMiner M66S++', 
            efficiency: '14.0 J/TH', 
            image: "img/WhatsMiner_M66S++.jpg" 
        }
    ],

    // Ù‚Ø³Ù… Ø®Ø·Ø· Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±
    PLANS: [
        {
            id: 'pro_contract', // Ù…Ø¹Ø±Ù ÙØ±ÙŠØ¯ Ù„Ù„Ø®Ø·Ø©
            name: 'Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ (Pro)',
            price: 200.00,
            duration_months: 12,
            hashrate: 10, // TH/s
            device_source: 'Antminer S21 XP',
            profits: { // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ÙÙŠ ÙƒØ§Ø¦Ù† ÙˆØ§Ø­Ø¯
                daily: 0.4075,
                monthly: 12.22,
                annual: 148.73
            },
            bonus: null // Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙƒØ§ÙØ£Ø© Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·Ø©
        },
        {
            id: 'advanced_contract',
            name: 'Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ù…ØªÙ‚Ø¯Ù… (Advanced)',
            price: 500.00,
            duration_months: 12,
            hashrate: 26, // TH/s
            device_source: 'Antminer S21 XP',
            profits: {
                daily: 1.0595,
                monthly: 31.78,
                annual: 386.71
            },
            bonus: { // ÙƒØ§Ø¦Ù† Ø®Ø§Øµ Ù„Ù„Ù…ÙƒØ§ÙØ¢Øª Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªÙ†Ø¸ÙŠÙ…
                description: 'Ù…ÙƒØ§ÙØ£Ø© Ù†ØµÙ Ø³Ù†ÙˆÙŠØ©',
                amount: 125.00, // 25% of 500
                period_months: 6
            }
        },
        {
            id: 'elite_hydro_contract',
            name: 'Ø¹Ù‚Ø¯ Ø§Ù„Ù†Ø®Ø¨Ø© Ø§Ù„Ù…Ø§Ø¦ÙŠ (Elite Hydro)',
            price: 1000.00,
            duration_months: 12,
            hashrate: 55, // TH/s
            device_source: 'Antminer S21 XP Hydro',
            profits: {
                daily: 2.406,
                monthly: 72.18,
                annual: 878.19
            },
            bonus: {
                description: 'Ù…ÙƒØ§ÙØ£Ø© Ù†ØµÙ Ø³Ù†ÙˆÙŠØ©',
                amount: 250.00, // 25% of 1000
                period_months: 6
            }
        }
    ],

    // Ù‚Ø³Ù… Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø© (Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ± Ø¹Ù† Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…ØµØ­Ø­Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©)
    FAQ: [
        { q: 'Ù…Ø§ Ø·Ø¨ÙŠØ¹Ø© Ø¹Ù…Ù„ÙƒÙ…ØŸ', a: 'Ù†Ø­Ù† Ø´Ø±ÙƒØ© BTC-CloudXØŒ Ù†ÙˆÙØ± Ù„Ùƒ ÙØ±ØµØ© Ù„Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± ÙÙŠ ØªØ¹Ø¯ÙŠÙ† Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ø±Ù‚Ù…ÙŠØ© Ø¹Ø¨Ø± Ø´Ø±Ø§Ø¡ Ù‚ÙˆØ© ØªØ¹Ø¯ÙŠÙ†ÙŠØ© (Hashrate) Ù…Ù† Ù…Ø²Ø§Ø±Ø¹Ù†Ø§ Ø§Ù„Ù…Ø¬Ù‡Ø²Ø© Ø¨Ø£Ø­Ø¯Ø« Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©. Ù†ØªÙˆÙ„Ù‰ ÙƒÙ„ Ø´ÙŠØ¡ØŒ Ù…Ù† Ø§Ù„ØµÙŠØ§Ù†Ø© ÙˆØ§Ù„ØªØ´ØºÙŠÙ„ØŒ ÙˆØ£Ù†Øª ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø¨Ø´ÙƒÙ„ ÙŠÙˆÙ…ÙŠ.' },
        { q: 'ÙƒÙŠÙ ØªÙØ­Ø³Ø¨ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ØŸ', a: 'ØªØ¹ØªÙ…Ø¯ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙˆØ© Ø§Ù„ØªØ¹Ø¯ÙŠÙ†ÙŠØ© Ø§Ù„ØªÙŠ ØªÙ…Ù„ÙƒÙ‡Ø§ØŒ ÙˆØ³Ø¹Ø± Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ† Ø§Ù„Ø­Ø§Ù„ÙŠØŒ ÙˆØµØ¹ÙˆØ¨Ø© Ø§Ù„Ø´Ø¨ÙƒØ©. ØªÙØ®ØµÙ… Ø±Ø³ÙˆÙ… Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡ ÙˆØ§Ù„ØµÙŠØ§Ù†Ø© ÙŠÙˆÙ…ÙŠÙ‹Ø§ Ù…Ù† Ø§Ù„Ù†Ø§ØªØ¬ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØŒ ÙˆØ§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù‡Ùˆ Ø±Ø¨Ø­Ùƒ Ø§Ù„ØµØ§ÙÙŠ. Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± ÙŠÙ†Ø·ÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ø®Ø§Ø·Ø± ØªÙ‚Ù„Ø¨ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±.' },
        { q: 'Ù‡Ù„ Ø£Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø´Ù‡Ø§Ø¯Ø© Ø£Ùˆ Ø¥Ø«Ø¨Ø§ØªØŸ', a: 'Ù†Ø¹Ù…ØŒ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ Ø£ÙŠ Ø®Ø·Ø©ØŒ Ø³ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø´Ù‡Ø§Ø¯Ø© Ø§Ø³ØªØ«Ù…Ø§Ø± Ø±Ù‚Ù…ÙŠØ© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ØªÙØ§ØµÙŠÙ„ Ø¹Ù‚Ø¯ÙƒØŒ Ø¨Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ù…ÙØ¹Ø±Ù‘Ù Ø§Ø´ØªØ±Ø§Ùƒ ÙØ±ÙŠØ¯ (ID) Ø®Ø§Øµ Ø¨Ùƒ Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ø³ØªØ«Ù…Ø§Ø±Ùƒ.' },
        { q: 'ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠØŸ', a: 'ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ ÙØ±ÙŠÙ‚ Ø§Ù„Ø¯Ø¹Ù… Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ø¨Ø± Ø²Ø± "ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§" ÙÙŠ Ø§Ù„Ø¨ÙˆØªØŒ Ø£Ùˆ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ø¥Ù„Ù‰ Ù‚Ù†Ø§ØªÙ†Ø§ Ø¹Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù… Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø¢Ø®Ø± Ø§Ù„Ø£Ø®Ø¨Ø§Ø± ÙˆØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ø£Ø±Ø¨Ø§Ø­.' }
    ]
};

        // --- PAGE NAVIGATION LOGIC ---
        const pages = document.querySelectorAll('.page');
        const navButtons = document.querySelectorAll('.nav-btn');

        function showPage(pageId) {
            pages.forEach(page => page.classList.remove('active'));
            const newPage = document.getElementById(pageId);
            if (newPage) {
                newPage.classList.add('active');
            }
            navButtons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.page === pageId) {
                    btn.classList.add('active');
                }
            });
            // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† HapticFeedback Ù…Ø¯Ø¹ÙˆÙ… Ù‚Ø¨Ù„ Ø§Ø³ØªØ¯Ø¹Ø§Ø¦Ù‡
            if (tg.HapticFeedback && tg.HapticFeedback.impactOccurred) {
                tg.HapticFeedback.impactOccurred('light');
            }
        }

        navButtons.forEach(button => {
            button.addEventListener('click', () => showPage(button.dataset.page));
        });

        // --- DYNAMIC CONTENT RENDERING ---
        function renderPlansPage() {
            const container = document.getElementById('plans-container');
            if (!container) return; // Ø­Ù…Ø§ÙŠØ© ÙÙŠ Ø­Ø§Ù„ Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¹Ù†ØµØ±
            container.innerHTML = DATA.PLANS.map(plan => {
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… JSON.stringify Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙˆØªÙ…Ø±ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø£Ù…Ø§Ù†
                const planData = encodeURIComponent(JSON.stringify(plan));
                return `
                <div class="bg-[var(--tg-theme-secondary-bg-color)] p-4 rounded-xl border border-[#30363d] shadow-lg">
                    <h2 class="text-2xl font-bold text-green-400">${plan.name}</h2>
                    <div class="mt-3 space-y-2 text-md">
                        <p><strong>ğŸ’° Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±:</strong> <span class="font-bold text-white">$${plan.price}</span></p>
                        <p><strong>âš™ï¸ Ø§Ù„Ù‚ÙˆØ© Ø§Ù„ØªØ¹Ø¯ÙŠÙ†ÙŠØ©:</strong> <span class="font-bold text-white">${plan.hashrate} TH/s</span></p>
                        <p><strong>ğŸ”Œ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ù…ØµØ¯Ø±:</strong> <span class="font-bold text-white">${plan.device}</span></p>
                        <hr class="border-gray-600 my-2">
                        <p><strong>ğŸ“ˆ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ø§Ù„ØµØ§ÙÙŠ:</strong> <span class="font-bold text-green-300">~$${plan.daily_profit.toFixed(2)}</span></p>
                        <p><strong>ğŸ“… Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø³Ù†ÙˆÙŠ Ø§Ù„ØµØ§ÙÙŠ:</strong> <span class="font-bold text-green-300">~$${plan.annual_profit.toFixed(2)}</span></p>
                    </div>
                    <button onclick='showPlanConfirmationModal(JSON.parse(decodeURIComponent("${planData}")))' class="w-full mt-4 text-white p-3 rounded-lg font-bold" style="background-color: var(--tg-theme-button-color);">
                        Ø§Ø´ØªØ±Ùƒ Ø§Ù„Ø¢Ù†
                    </button>
                </div>
                `}).join('');
        }

        function renderHardwarePage() {
            const container = document.getElementById('hardware-container');
            if (!container) return;
            container.innerHTML = DATA.HARDWARE.map(device => `
                <div class="bg-[var(--tg-theme-secondary-bg-color)] p-4 rounded-xl border border-[#30363d] text-center cursor-pointer" onclick="showHardwareModal('${device.id}')">
                    <img src="${device.image}" alt="${device.name}" class="rounded-md w-full h-40 object-cover mb-3">
                    <h2 class="text-xl font-bold">${device.name}</h2>
                    <p class="text-gray-400">Ø§Ù„ÙƒÙØ§Ø¡Ø©: ${device.efficiency}</p>
                </div>
            `).join('');
        }

        function renderFaqPage() {
            const container = document.getElementById('faq-container');
            if (!container) return;
            container.innerHTML = DATA.FAQ.map((item, index) => `
                <div class="bg-[var(--tg-theme-secondary-bg-color)] rounded-lg border border-[#30363d]">
                    <button class="accordion-toggle w-full p-4 text-right font-bold flex justify-between items-center" data-index="${index}">
                        <span>${item.q}</span>
                        <span class="transform transition-transform duration-300">+</span>
                    </button>
                    <div class="accordion-content px-4 pb-4 text-gray-300">
                        <p>${item.a}</p>
                    </div>
                </div>
            `).join('');
            
            document.querySelectorAll('.accordion-toggle').forEach(button => {
                button.addEventListener('click', (event) => {
                    const currentButton = event.currentTarget;
                    const content = currentButton.nextElementSibling;
                    const icon = currentButton.querySelector('span:last-child');
                    const isOpen = content.style.maxHeight;

                    // Ø£ØºÙ„Ù‚ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙƒÙˆØ±Ø¯ÙŠÙˆÙ†Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰
                    document.querySelectorAll('.accordion-content').forEach(c => c.style.maxHeight = null);
                    document.querySelectorAll('.accordion-toggle span:last-child').forEach(i => i.style.transform = 'rotate(0deg)');

                    // Ø§ÙØªØ­ Ø§Ù„Ø£ÙƒÙˆØ±Ø¯ÙŠÙˆÙ† Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØºÙ„Ù‚Ù‹Ø§
                    if (!isOpen) {
                        content.style.maxHeight = content.scrollHeight + "px";
                        icon.style.transform = 'rotate(45deg)';
                    }
                });
            });
        }

        // --- MODAL LOGIC ---
        const hardwareModal = document.getElementById('hardware-modal');
        const modalBody = document.getElementById('modal-body');
        const planModal = document.getElementById('plan-confirmation-modal');
        const planModalBody = document.getElementById('plan-modal-body');
        const planModalFooter = document.getElementById('plan-modal-footer');

        function showHardwareModal(deviceId) {
            const device = DATA.HARDWARE.find(d => d.id === deviceId);
            if (!device) return;
            
            modalBody.innerHTML = `
                <img src="${device.image}" alt="${device.name}" class="rounded-lg w-full mb-4">
                <h2 class="text-2xl font-bold">${device.name}</h2>
                <p class="text-lg text-gray-300 mt-2">ÙƒÙØ§Ø¡Ø© Ø§Ù„Ø·Ø§Ù‚Ø©: ${device.efficiency}</p>
                <p class="mt-4 text-gray-400">Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø² Ù…Ù† Ø£ÙØ¶Ù„ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© ÙÙŠ ÙØ¦ØªÙ‡ØŒ ÙˆÙŠØ³ØªØ®Ø¯Ù… ÙÙŠ Ø®Ø·Ø·Ù†Ø§ Ù„Ø¶Ù…Ø§Ù† Ø£Ø¹Ù„Ù‰ Ø¹Ø§Ø¦Ø¯ Ù…Ù…ÙƒÙ† Ù„Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ†.</p>
            `;
            hardwareModal.style.display = 'flex';
        }

        function showPlanConfirmationModal(plan) {
            planModalBody.innerHTML = `
                <h3 class="text-xl font-bold mb-3">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</h3>
                <p class="mb-4">Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ Ø§Ù„Ø®Ø·Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©ØŸ</p>
                <div class="text-right space-y-2 p-3 bg-[#010409] rounded-lg border border-gray-700">
                    <p><strong>Ø§Ù„Ø®Ø·Ø©:</strong> ${plan.name}</p>
                    <p><strong>Ø§Ù„Ø³Ø¹Ø±:</strong> $${plan.price}</p>
                    <p><strong>Ø§Ù„Ù‚ÙˆØ©:</strong> ${plan.hashrate} TH/s</p>
                    <p><strong>Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø³Ù†ÙˆÙŠ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠ:</strong> ~$${plan.annual_profit.toFixed(2)}</p>
                </div>
            `;

            planModalFooter.innerHTML = `
                <button onclick="redirectToSupport()" class="w-2/5 text-white p-2 rounded-lg font-bold bg-green-600 hover:bg-green-700">Ù†Ø¹Ù…ØŒ Ø£ÙˆØ§ÙÙ‚</button>
                <button onclick="closePlanModal()" class="w-2/5 text-white p-2 rounded-lg font-bold bg-red-600 hover:bg-red-700">Ù„Ø§ØŒ ØªØ±Ø§Ø¬Ø¹</button>
            `;

            planModal.style.display = 'flex';
        }

        function closePlanModal() {
            planModal.style.display = 'none';
        }

        function redirectToSupport() {
            tg.openTelegramLink(TELEGRAM_SUPPORT_URL);
            closePlanModal();
        }

        window.onclick = (event) => {
            if (event.target == hardwareModal) {
                hardwareModal.style.display = "none";
            }
            if (event.target == planModal) {
                planModal.style.display = "none";
            }
        }

        // --- CREATE CUSTOM PLAN LOGIC ---
        const investmentAmountInput = document.getElementById('investment_amount');
        const durationInput = document.getElementById('investment_duration');
        const durationDisplay = document.getElementById('duration_display');
        const calculateBtn = document.getElementById('calculate-plan-btn');
        const resultsDiv = document.getElementById('plan-results');

        durationInput.addEventListener('input', () => {
            durationDisplay.textContent = durationInput.value;
        });

        calculateBtn.addEventListener('click', () => {
            const amount = parseFloat(investmentAmountInput.value);
            const durationYears = parseInt(durationInput.value);

            if (isNaN(amount) || amount < 1000) {
                tg.showAlert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº Ø§Ø³ØªØ«Ù…Ø§Ø± ØµØ§Ù„Ø­ ( 1000 Ø¯ÙˆÙ„Ø§Ø± ÙƒØ­Ø¯ Ø£Ø¯Ù†Ù‰).');
                return;
            }

            let pricePerTh = 20;
            if (amount >= 500) pricePerTh = 19.23;
            if (amount >= 1000) pricePerTh = 18.18;
            const totalHashrate = amount / pricePerTh;

            let feePerTh = 0.038;
            if (amount >= 1000) feePerTh = 0.035;

            const btcPerThPerDay = 0.00000105;
            const btcPrice = 75000;

            const grossDailyIncome = totalHashrate * btcPerThPerDay * btcPrice;
            const totalDailyFees = totalHashrate * feePerTh;
            const netDailyProfit = grossDailyIncome - totalDailyFees;

            const netMonthlyProfit = netDailyProfit * 30;
            const netAnnualProfit = netDailyProfit * 365;
            const baseProfit = netAnnualProfit * durationYears;

            // âœ… Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ 25% Ù†Øµ Ø³Ù†ÙˆÙŠ
            const semiAnnualBonus = amount * 0.25 * durationYears * 2;
            const totalProfit = baseProfit + semiAnnualBonus;

            resultsDiv.innerHTML = `
                <h3 class="text-xl font-bold text-center text-green-400">Ù†ØªØ§Ø¦Ø¬ Ø®Ø·ØªÙƒ Ø§Ù„Ù…Ø®ØµØµØ©</h3>
                <p><strong>- Ø§Ù„Ù‚ÙˆØ© Ø§Ù„ØªØ¹Ø¯ÙŠÙ†ÙŠØ©:</strong> ${totalHashrate.toFixed(2)} TH/s</p>
                <p><strong>- ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ÙŠÙˆÙ…ÙŠ:</strong> ~$${netDailyProfit.toFixed(2)}</p>
                <p><strong>- ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø´Ù‡Ø±ÙŠ:</strong> ~$${netMonthlyProfit.toFixed(2)}</p>
                <p><strong>- Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±Ø¨Ø­ (${durationYears} Ø³Ù†ÙˆØ§Øª):</strong> ~$${baseProfit.toFixed(2)}</p>
                <p><strong>- Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ (25% Ã— ÙƒÙ„ 6 Ø´Ù‡ÙˆØ±):</strong> ~$${semiAnnualBonus.toFixed(2)}</p>
                <hr class="border-gray-600 my-2">
                <p class="font-bold text-white text-xl">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒÙ„ÙŠ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹: ~$${totalProfit.toFixed(2)}</p>
                <p class="text-xs text-gray-400">Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ØªÙ‚Ø¯ÙŠØ±ÙŠØ© ÙˆØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ† Ø§Ù„Ø­Ø§Ù„ÙŠ ÙˆØµØ¹ÙˆØ¨Ø© Ø§Ù„Ø´Ø¨ÙƒØ©.</p>
                <button id="submit-plan-btn" class="w-full mt-4 text-white p-3 rounded-lg font-bold" style="background-color: var(--tg-theme-button-color);">Ø£Ø±Ø³Ù„ Ø§Ù„Ø®Ø·Ø© Ù„Ù„Ø¨ÙˆØª ÙˆØ§Ø·Ù„Ø¨Ù‡Ø§</button>
            `;
            resultsDiv.classList.remove('hidden');

            document.getElementById('submit-plan-btn').addEventListener('click', () => {
                const dataToSend = {
                    action: 'create_custom_plan',
                    payload: {
                        investment: amount,
                        duration: durationYears,
                        hashrate: totalHashrate.toFixed(2),
                        totalProfit: totalProfit.toFixed(2)
                    }
                };
                tg.sendData(JSON.stringify(dataToSend));
            });
            tg.HapticFeedback.impactOccurred('medium');
        });

        // --- INITIALIZE APP ---
        document.addEventListener('DOMContentLoaded', () => {
            renderPlansPage();
            renderHardwarePage();
            renderFaqPage();
            showPage('home-page');
        });
    </script>
</body>
</html>
